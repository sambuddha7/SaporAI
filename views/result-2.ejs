<%- include("partials/user-header") %>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="/result-script.js" defer></script>
<div class="link-wrapper">
  <a href="https://forms.gle/BERUe2JhBEgaFyz26" class="vertical-link">Feedback?</a>
</div>
  <div class="dashboard-container">
    <div class="result-body">
      <input value="<%=last_ai%>" style="display:none" id="last_ai"> 
      <div class = "recipe-header">
        <% const recName = recipeName.split(':'); %>
        <h3>
          <%= recName.length == 1 ? recName[0] : recName[1] %>
          <button id="regenerate-btn" class="btn btn-outline-info">Regenerate</button>
        </h3>
      </div>
      <!-- <h3> <%= recipeName %></h3> --> 
      <div id="nutr-container" class="card-n">
        <% const nutri = nutrInfo %>
        <%const lines = nutri.split('\n');%>
  
        <%const nutArray = []%>
        <%const nonEmptyLines = lines.filter(line => line.trim() !== '');%>
      

      

        <%for (let i = 1; i < nonEmptyLines.length; i++) {%>
        <%  const trimmedLine = nonEmptyLines[i].trim();%>

        <%  const [key, value] = trimmedLine.split(':');%>
        <% lit = trimmedLine %>
        <% if (lit.substring(0,1) == '-' || lit.substring(0,1) == '*') {%>
        <% lit = lit.substring(1);%>
        <% }%>
     
        <% nutArray.push(lit)%>
        <%}%>
        <div class="card-n-content">
          <h5 style="text-align:center; margin-bottom: 3%;">Nutritional info</h5>
          <ul class="nut-list">
            <div class="container text-center">
              <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4">
                  <% for (let i = 0; i < nutArray.length; i++) { %>
                    <div class="col"><li><%= nutArray[i] %></li></div>
                  <% } %>
              </div>
            </div>
          </ul>
        </div>
        
      </div>
      <div class="ingr-container">
        <h5>Ingredients:</h5>
        <% const ing = ingr %>
        <%const lines2 = ing.split('\n');%>
        <ul class="ing-list">
        <% for (let i = 2; i < lines2.length; i++) { %>
          <li><%= lines2[i] %></li>
        <% } %>
        </ul>
      </div>
      <div class="step-container">
        <h5>Instructions:</h5>
        <% const step = steps %>
        <%const lines3 = step.split('\n');%>
        <ul class="ing-list">
          <% for (let i = 2; i < lines3.length; i++) { %>
            <li><%= lines3[i] %></li>
          <% } %>
          </ul>
      </div>
      
      
    </div>
  </div>
<%- include("partials/footer"); -%>
